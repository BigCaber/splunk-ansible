---
- name: Check if UDS file exists
  stat:
    path: '{{ splunk.home }}/var/run/splunk/cli.socket'
  register: client_socket_file

- name: Check if listening on 8089
  shell: "netstat -plnt"
  register: port_status
  #when: not client_socket_file.stat.exists

- name: UF is configured to use UDS
  debug:
    msg: "UF(s) is configured to use UDS"
  when: client_socket_file.stat.exists and port_status.stdout.find("8089") == -1

- name: UF is configured to use TCP
  debug:
    msg: "UF is configured to use TCP"
  when: not client_socket_file.stat.exists and port_status.stdout.find("8089") != -1
